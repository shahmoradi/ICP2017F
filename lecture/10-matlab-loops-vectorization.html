<!DOCTYPE html>
<html>
<head>

<!--
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
<script src="/ICP2017F/assets/js/mdHeaderCollapse.js"></script>
-->

<meta charset="utf-8">
<title>LECTURE 10: MATLAB - LOOPS AND VECTORIZATION &vert; COE 301 - FALL 2017 - MWF 9-10 AM - UTC 4.110</title>
<meta name="description" content="Introduction to<br>Computer Programming">
<meta name="keywords" content="">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/ICP2017F/images/logo.png">
<meta name="twitter:title" content="Lecture 10: MATLAB - loops and vectorization">
<meta name="twitter:description" content="Introduction to<br>Computer Programming">
<meta name="twitter:creator" content="@AmirShahmoradi">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Lecture 10: MATLAB - loops and vectorization">
<meta property="og:description" content="Introduction to<br>Computer Programming">
<meta property="og:url" content="/ICP2017F/lecture/10-matlab-loops-vectorization">
<meta property="og:site_name" content="COE 301 - Fall 2017 - MWF 9-10 AM - UTC 4.110">
<meta property="og:image" content="/ICP2017F/images/">





<link rel="canonical" href="/ICP2017F/lecture/10-matlab-loops-vectorization">
<!-- <link href="/ICP2017F/feed.xml" type="application/atom+xml" rel="alternate" title="COE 301 - Fall 2017 - MWF 9-10 AM - UTC 4.110 Feed"> -->


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

<link href='http://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/ICP2017F/assets/css/vendor/font-awesome.min.css">
<link rel="stylesheet" href="/ICP2017F/assets/css/vendor/normalize.css">
<link rel="stylesheet" href="/ICP2017F/assets/css/vendor/nprogress.css">
<link rel="stylesheet" href="/ICP2017F/assets/css/vendor/foundation.min.css">
<link rel="stylesheet" href="/ICP2017F/assets/css/style.css">
<link rel="stylesheet" href="/ICP2017F/assets/css/post.css">

<!--Mathjax-->

<style TYPE="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
<script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<!-- Icons -->
<link rel="shortcut icon" href="/ICP2017F/favicon.ico">
<link rel="shortcut icon" href="/ICP2017F/favicon.png">


<!-- prism
<link href="/ICP2017F/assets/css/prismTwilight.css" rel="stylesheet" />
<link href="/ICP2017F/assets/css/prismDefault.css" rel="stylesheet" />
<link href="/ICP2017F/assets/css/prismCoy.css" rel="stylesheet" />
-->
<link href="/ICP2017F/assets/css/prismOkaidia.css" rel="stylesheet" />

<!--header anchor links-->
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

<style type="text/css">@media only screen and (min-width:43.75em){.notepad-post-content div>p:first-child:first-letter{float:left;font-size:4.688rem;line-height:4.375rem;padding-top:.25rem;padding-right:.5rem;padding-left:.188rem;font-family:serif}}</style>
</head>
<body class="post-template" itemscope itemtype="http://schema.org/WebPage">  

        <main id="notepad-post-container-simple" class="notepad-post-container-simple" role="main">
            <header class="notepad-post-header-simple">
                <div class="notepad-post-menu-header-simple">

                    <a class="notepad-blog-logo" href="/ICP2017F" target="_blank"><img src="/ICP2017F/images/logo.png" alt="shahmoradi.org" /></a>

                <div class="notepad-blog-menu">      
    <div class="notepad-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="notepad-menu">
        <li class="notepad-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="/ICP2017F/">Home</a>
                 </li>

            <li>
                    <a href="/ICP2017F/highlights">Highlights</a>
                 </li>

            <li>
                    <a href="/ICP2017F/categories">Categories</a>
                 </li>

            <li>
                    <a href="/ICP2017F/about">About</a>
                 </li>
            
           <li><a href="/ICP2017F/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
    </ul>

</div>
            </div>

                <div class="notepad-post-title-simple row">
                    <div class="small-12 columns">
                        <div class="notepad-post-meta-simple">
                            <h2>Lecture 10: MATLAB - loops and vectorization</h2>
                            <p>by <strong>Amir Shahmoradi</strong> &#8212;  <strong><time datetime="2017-10-27T00:00:00-05:00">27 Oct 2017</time></strong></p>
                        </div>
                    </div>
                </div>
            </header>

        
            <article class="notepad-post-content post tag-simple">
        
            <div style="text-align:justify;">
                <p>This lecture explains the concept of for-loops and while-loops in MATLAB and different of types of it in MATLAB.</p>

<div class="post_toc"></div>

<!--

## Lecture Videos

This video is created solely as reference for the attendants of ICP2017F course at UT Austin. If you did not attend this class, then you may not find this video useful.

<div class="center"><div class="video-wrapper"><div class="video-container">
    <iframe width="853" height="480" src="https://www.youtube.com/embed/4Fx4ulZt0_c" frameborder="0" allowfullscreen></iframe>
</div></div></div><br>

-->

<h2 id="loops-in-matlab">Loops in MATLAB</h2>

<p>Many programming algorithms require iteration, that is, the repetitive execution of a block of program statements. Similar to other programming languages, MATLAB also has built-in tools for iterative tasks in codes.</p>

<h3 id="for-loop">For-loop</h3>

<p>The for-loop is among the most useful MATLAB constructs. The general syntax of for-loop is,</p>
<pre><code class="language-matlab">for variable = expression
    statements
end
</code></pre>
<p><br />
Usually, <code>expression</code> is a vector of the form <code>istart:stepSize:iend</code> where <code>fix((iend-istart)/stepSize+1)</code> gives the number of iterations requested by the user, assuming <code>iend&gt;istart</code>. The <code>statements</code> are the set of programming tasks that have to be repeated. For example consider a script named <code>forLoop.m</code>,</p>
<pre><code class="language-matlab">for index = istart:stepSize:iend
    disp(index);
end
disp( [ 'number of iterations: ', num2str( fix((iend-istart)/stepSize+1) ) ] );
</code></pre>
<pre><code class="language-matlab">&gt;&gt; istart = -2;
iend = 10;
stepSize = 3;
forLoop
    -2
     1
     4
     7
    10
number of iterations: 5
</code></pre>
<p><br />
You can also iterate in reverse order,</p>
<pre><code class="language-matlab">&gt;&gt; istart = 10;
iend = -2;
stepSize = -3;
forLoop
    10
     7
     4
     1
    -2
number of iterations: 5
</code></pre>
<p><br /></p>

<h4 id="breaking-a-for-loop-immaturely">Breaking a for-loop immaturely</h4>

<p>You can also use <code>break</code> inside a for-loop to get out of it, even before the for-loop finishes the full number of iterations. This is specially useful when you want to ensure if a condition has happened, and if so, then terminate the for-loop. For example,</p>
<pre><code class="language-matlab">for integer = 1:10
    disp(integer)
    if (integer==5)
        break
    end
end
</code></pre>
<pre><code> 1
 2
 3
 4
 5
</code></pre>

<p><strong>Exercise:</strong><br />
suppose you want to find the largest prime number that is smaller than a given input value by the user. Write a function that does so, using for-loop, <code>break</code>, and MATLAB’s intrinsic function <code>isprime()</code>.</p>

<!--
**Answer:**  
```matlab
function integer = getPrime(upper)
    if (upper<1)
        disp('input value cannot be less than 1. Goodbye!')
        return
    end
    for integer = upper:-1:1
        if isprime(integer)
            break
        end
    end
end
```
<br>
-->

<h4 id="continue-statement-within-for-loops">Continue statement within for-loops</h4>

<p>To skip the rest of the instructions in a loop and begin the next iteration, you can use a <code>continue</code> statement. For example, the following code prints only integers that are primes,</p>
<pre><code class="language-matlab">for integer = 1:10
    if ~isprime(integer)
        continue
    end
    disp(['prime detected! ',num2str(integer)])
end
</code></pre>
<pre><code>prime detected! 2
prime detected! 3
prime detected! 5
prime detected! 7
</code></pre>

<h4 id="iterating-over-vectors-matrices-and-cell-using-for-loops">Iterating over vectors, matrices, and cell using for-loops</h4>

<p>Note that the index of for-loop must not necessarily be an integer. Basically you can use the for-loop index to iterate over anything that is iterable in MATLAB. For example, consider the following,</p>
<pre><code class="language-matlab">a = [1,0,2,3,7,-1];
for index = a
    disp(class(index))
    disp(index)
end
</code></pre>
<p><br />
The output of this script is,</p>

<pre><code>double
    1
double
    0
double
    2
double
    3
double
    7
double
    -1
</code></pre>

<p>But, see what happens if we defined <code>a</code> as a matrix,</p>
<pre><code class="language-matlab">a = [1, 2, 3; 4, 5, 6; 7, 8, 9];
for index = a
    disp(class(index))
    disp(index)
end
</code></pre>
<pre><code>double
    1
    4
    7
double
    2
    5
    8
double
    3
    6
    9
</code></pre>

<p>What is happening here? The answer is that, MATLAB is a <a href="https://en.wikipedia.org/wiki/Row-_and_column-major_order" target="_blank">column-wise programming language</a>, just like Fortran, and unlike C, C++ and all of their descendants. <strong>MATLAB, by default, iterates over elements of row vectors</strong>. Therefore, when you use a matrix as the iterator in for-loops, MATLAB considers an entire column as the index of for-loop. The same is also true for other multidimensional arrays in MATLAB, for example cell arrays,</p>
<pre><code class="language-matlab">a = {1, 2, 3; 4, 5, 6; 7, 8, 9};
for index = a
    disp(class(index))
    disp(index)
end
</code></pre>
<pre><code>cell
    [1]
    [4]
    [7]
cell
    [2]
    [5]
    [8]
cell
    [3]
    [6]
    [9]
</code></pre>

<p>Therefore, if you want to iterate over elements of a multidimensional matrix or array, you have to first reshape them using MATLAB’s built-in <code>reshape()</code> function to convert them to vector format, then iterating over them. For exzmple,</p>
<pre><code class="language-matlab">a = {1, 2, 3; 4, 5, 6; 7, 8, 9};
a = reshape(a,[1,9]);
for index = a
    disp(class(index))
    disp(index)
end
</code></pre>
<pre><code>cell
    [1]
cell
    [4]
cell
    [7]
cell
    [2]
cell
    [5]
cell
    [8]
cell
    [3]
cell
    [6]
cell
    [9]
</code></pre>

<h4 id="some-general-advice-on-for-loop-index">Some general advice on for-loop index</h4>

<ul>
  <li><strong>Avoid using $i$ and $j$ as index variables in for-loops.</strong> Note that <code>i</code> and <code>j</code> have special meanings in MATLAB, as described in previous lectures. They are used to define complex numbers. Using these variable names as indices in MATLAB for-loops, would overwrite the default meaning of these variables.<br />
<br /></li>
  <li><strong>Avoid assigning a value to the index variable within the loop statements.</strong> The for statement overrides any changes made to index within the loop.</li>
</ul>

<h3 id="while-loop">While-loop</h3>

<p>There is another iteration construct in MATLAB, called <strong>while-loop</strong> which has the following general syntax,</p>
<pre><code class="language-matlab">while expression
    statements
end
</code></pre>
<p><br />
The <code>statements</code> within the while-loop are executed as long as <code>expression</code> is true. For example,</p>
<pre><code class="language-matlab">x = realmax();
while x&gt;0
    xmin = x
    x = log(x)
end
xmin
</code></pre>
<pre><code>xmin =
1.7977e+308
x =
709.7827
xmin =
709.7827
x =
    6.5650
xmin =
    6.5650
x =
    1.8817
xmin =
    1.8817
x =
    0.6322
xmin =
    0.6322
x =
-0.4585
xmin =
    0.6322
</code></pre>

<p>Note that, <code>break</code> and <code>continue</code> can be used in while-loops in the same fashion as they are used in for-loops, described above. The condition is evaluated before the body is executed, so it is possible to get zero iterations. It’s often a good idea to limit the number of repetitions to avoid infinite loops (as could happen above if x is infinite). This can be done in a number of ways, but the most common is to use <code>break</code>. For example,</p>
<pre><code class="language-matlab">n = 0;
while abs(x) &gt; 1
    x = x/2;
    n = n+1;
    if n &gt; 50, break, end
end
</code></pre>
<p><br />
A break immediately jumps execution to the first statement after the loop. It’s good practice to include some diagnostic output or other indication that an abnormal loop exit has occurred once the code reach the <code>break</code> statement.</p>

<p><strong>Exercise:</strong><br />
Write function <code>getFac(n)</code> using while-loop, that calculates the factorial of an input number <code>n</code>. For example,</p>
<pre><code class="language-matlab">&gt;&gt; getFac(4)
4! = 24
</code></pre>
<p><br /></p>

<!--  
**Answer:**
```matlab
function getFac(n)
    nOrg = n;
    fac = n;
    while n > 1
        n = n-1;
        fac = fac*n;
    end
    disp([num2str(nOrg),'! = ' num2str(fac)])
end
```
<br>
-->

<h4 id="some-general-advice-on-while-loops">Some general advice on while-loops</h4>

<ul>
  <li>If you inadvertently create an infinite loop (that is, a loop that never ends on its own), stop execution of the loop by pressing Ctrl+C.<br />
<br /></li>
  <li>If the conditional expression evaluates to a matrix, MATLAB evaluates the statements only if <strong>all</strong> elements in the matrix are true (nonzero). To execute statements if any element is true, wrap the expression in the <code>any()</code> function.<br />
<br /></li>
  <li>To exit the loop, use a <code>break</code> statement as discussed above. To skip the rest of the instructions in the loop and begin the next iteration, use a <code>continue</code> statement.<br />
<br /></li>
  <li>When nesting a number of while statements, each while statement requires an <code>end</code> keyword.</li>
</ul>

<h2 id="vectorization-in-matlab">Vectorization in MATLAB</h2>

<p>Experienced programmers who are concerned with producing compact and fast code try to avoid for loops wherever possible in their MATLAB codes. There is a reason for this: for-loops and while-loops have significant overhead in interpreted languages such as MATLAB and Python.</p>

<p>There is of course, a remedy for this inefficiency. Since MATLAB is a matrix language, many of the matrix-level operations and functions are carried out internally using compiled C, Fortran, or assembly codes and are therefore executed at near-optimum efficiency. This is true of the arithmetic operators <code>*</code>, <code>+</code>,<code>-</code>,<code>\</code>, <code>/</code> and of relational and logical operators. However, for loops may be executed
relatively slowly—depending on what is inside the loop, MATLAB may or may not
be able to optimize the loop. One of the most important tips for producing efficient M-files is to avoid for -loops in favor of vectorized constructs, that is, to convert for-loops into equivalent vector or matrix operations. Vectorization has important benefits beyond simply increasing speed of execution. It can lead to shorter and more readable MATLAB code. Furthermore, it expresses algorithms in terms of high-level constructs that are more appropriate for high-performance computing. For example, consider the process of summation of a random vector in MATLAB,</p>
<pre><code class="language-matlab">&gt;&gt; n = 5e7; x = randn(n,1);
&gt;&gt; tic, s = 0; for i=1:n, s = s + x(i)^2; end, toc
</code></pre>
<pre><code>Elapsed time is 0.581945 seconds.
</code></pre>

<p>Now doing the same thing, using array notation would yield,</p>
<pre><code class="language-matlab">&gt;&gt; tic, s = sum(x.^2); toc
</code></pre>
<pre><code>Elapsed time is 0.200450 seconds.
</code></pre>

<p>Amazing! isn’t it? You get almost 3x speedup in your MATLAB code f you use vectorized computation instead of fol-loops. Later on in this course, we will see that MATLAB has inherited these vectorization excellent techniques and syntax for matrix calculations, from its high-performance ancestor, <a href="https://en.wikipedia.org/wiki/Fortran" target="_blank">Fortran</a>.</p>

<p><strong>Exercise:</strong><br />
How do you vectorize the following code?</p>
<pre><code class="language-matlab">i = 0;
for t = 0:.01:10
    i = i + 1;
    y(i) = sin(t);
end
</code></pre>
<p><br /></p>

<!--
**Answer:**  
```matlab
t = 0:.01:10;
y = sin(t);
```
<br>
-->

<h3 id="vectorization-of-array-operations">Vectorization of array operations</h3>

<p>Vectorization of arrays can be done through <strong>array operators</strong>, which perform the same operation for all elements in the data set. These types of operations are useful for repetitive calculations. For example, suppose you collect the volume (V) of various cones by recording their diameter (D) and height (H). If you collect the information for just one cone, you can calculate the volume for that single cone as,</p>
<pre><code class="language-matlab">&gt;&gt; D = 0.2;
&gt;&gt; H = 0.04;
&gt;&gt; V = 1/12*pi*(D^2)*H
V =
   4.1888e-04
</code></pre>
<p><br />
Now, suppose we collect information on 10,000 cones. The vectors <code>D</code> and <code>H</code> each contain 10,000 elements, and you want to calculate 10,000 volumes. In most programming languages (except Fortran and R which have similar vectorization capabilities to MATLAB), you need to set up a loop similar to this MATLAB code (here instead of 10000, I am using 7):</p>
<pre><code class="language-matlab">&gt;&gt; D = [-0.2 1.0 1.5 3.0 -1.0 4.2 3.14];
&gt;&gt; H = [0.0400 1.0000 2.2500 9.0000 1.0000 17.6400 9.8596];
for n = 1:7
   V(n) = 1/12*pi*(D(n)^2)*H(n);
end
&gt;&gt; V
V =
    0.0004    0.2618    1.3254   21.2058    0.2618   81.4640   25.4500
</code></pre>
<p><br />
With MATLAB, you can perform the calculation for each element of a vector with similar syntax as the scalar case,</p>
<pre><code class="language-matlab">&gt;&gt; V = 1/12*pi*(D.^2).*H;  % Vectorized Calculation
&gt;&gt; V
V =
    0.0004    0.2618    1.3254   21.2058    0.2618   81.4640   25.4500
</code></pre>
<p><br /></p>
<blockquote>
    <b>NOTE</b><br /><br />
    Placing a period (<code>.</code>) before the operators <code>*</code>, <code>/</code>, and <code>^</code>, transforms them into array operators.
</blockquote>
<p><br /></p>

<h3 id="logical-array-operations">Logical array operations</h3>

<p>MATLAB comparison operators also accept vector inputs and return vector outputs. For example, suppose while collecting data from 10,000 cones, you record several negative values for the diameter. You can determine which values in a vector are valid with the <code>&gt;=</code> operator,</p>
<pre><code class="language-matlab">&gt;&gt; D = [-0.2 1.0 1.5 3.0 -1.0 4.2 3.14];
&gt;&gt; D &gt;= 0
ans =
     0     1     1     1     0     1     1
&gt;&gt; class(ans)
ans =
logical
</code></pre>
<p><br />
You can directly exploit the logical indexing power of MATLAB to select the valid cone volumes, <code>Vgood</code>, for which the corresponding elements of D are nonnegative,</p>
<pre><code class="language-matlab">&gt;&gt; Vgood = V(D &gt;= 0) % removing all data corresponding to negative diameters
Vgood =
    0.2618    1.3254   21.2058   81.4640   25.4500
</code></pre>
<p><br />
MATLAB allows you to perform a logical AND or OR on the elements of an entire vector with the functions all and any, respectively. You can throw a warning if all values of <code>D</code> are below zero,</p>
<pre><code class="language-matlab">if all(D &lt; 0) % gives no warning because not all values are negative
   warning('All values of diameter are negative.')
end
</code></pre>
<p><br />
or,</p>
<pre><code class="language-matlab">&gt;&gt; if (D &lt; 0)
   warning('Some values of diameter are negative.')
end
Warning: Some values of diameter are negative. 
</code></pre>
<p><br />
MATLAB can also compare two vectors of the same size, allowing you to impose further restrictions. This code finds all the values where <code>V</code> is nonnegative and <code>D</code> is greater than <code>H</code>,</p>
<pre><code class="language-matlab">&gt;&gt; D = [-0.2 1.0 1.5 3.0 -1.0 4.2 3.14];
&gt;&gt; H = [0.0400 1.0000 2.2500 1.5000 1.0000 0.6400 9.8596];
&gt;&gt; V((V &gt;= 0) &amp; (D &gt; H))
ans =
   21.2058   81.4640
&gt;&gt; V
V =
    0.0004    0.2618    1.3254   21.2058    0.2618   81.4640   25.4500
&gt;&gt; (V &gt;= 0) &amp; (D &gt; H)
ans =
     0     0     0     1     0     1     0
</code></pre>
<p><br />
The resulting vector is the same size as the inputs. To aid comparison, MATLAB contains special values to denote <strong>overflow</strong>, <strong>underflow</strong>, and <strong>undefined operators</strong>, such as <strong>inf</strong> and <strong>nan</strong>. Logical operators <a href="https://www.mathworks.com/help/matlab/ref/isinf.html" target="_blank">isinf</a> and <a href="https://www.mathworks.com/help/matlab/ref/isnan.html" target="_blank">isnan</a> exist to help perform logical tests for these special values. For example, it is often useful to exclude <code>NaN</code> values from computations,</p>
<pre><code class="language-matlab">&gt;&gt; x = [2 -1 0 3 NaN 2 NaN 11 4 Inf];
&gt;&gt; xvalid = x(~isnan(x))
xvalid =
     2    -1     0     3     2    11     4   Inf
</code></pre>
<p><br /></p>
<blockquote>
    <b>NOTE</b><br /><br />
    Note that <code>Inf == Inf</code> returns <code>true</code>; however, <code>NaN == NaN</code> always returns <code>false</code> in MATLAB.
</blockquote>
<p><br /></p>

<h3 id="matrix-operations">Matrix Operations</h3>

<p>Matrix operations act according to the rules of linear algebra. These operations are most useful in vectorization if you are working with multidimensional data. Suppose you want to evaluate a function, $F$, of two variables, $x$ and $y$,</p>

<script type="math/tex; mode=display">F(x,y) = x*\exp(-x2 - y2) ~.</script>

<p>To evaluate this function at every combination of points in the $x$ and $y$, you need to define a grid of values,</p>
<pre><code class="language-matlab">&gt;&gt; x = -2:0.2:2;
&gt;&gt; y = -1.5:0.2:1.5;
&gt;&gt; [X,Y] = meshgrid(x,y);
&gt;&gt; F = X.*exp(-X.^2-Y.^2);
</code></pre>
<p><br />
Without <code>meshgrid()</code>, you might need to write two for loops to iterate through vector combinations. The function <code>ndgrid()</code> also creates number grids from vectors, but unlike <code>meshgrid()</code>, it can construct grids beyond three dimensions. <code>meshgrid()</code> can only construct 2-D and 3-D grids.</p>

<p>The following table contains a list of MATLAB functions that are commonly used in vectorized codes,</p>

<table class="center">
<caption class="title" style="padding-bottom:10px;text-align:center;">
Table of MATLAB's most-widely used vectorization functions.
</caption>
<thead>
<tr>
<th><font size="4rm" color="red">Function</font></th>
<th><font size="4rm" color="red">Description</font></th>
</tr>
</thead>
<tbody>

<tr><td><code>all</code></td><td>Determine if all array elements are nonzero or true</td></tr>
<tr><td><code>any</code></td><td>Determine if any array elements are nonzero</td></tr>
<tr><td><code>cumsum</code></td><td>Cumulative sum</td></tr>
<tr><td><code>diff</code></td><td>Differences and Approximate Derivatives</td></tr>
<tr><td><code>find</code></td><td>Find indices and values of nonzero elements</td></tr>
<tr><td><code>ind2sub</code></td><td>Subscripts from linear index</td></tr>
<tr><td><code>ipermute</code></td><td>Inverse permute dimensions of N-D array</td></tr>
<tr><td><code>logical</code></td><td>Convert numeric values to logicals</td></tr>
<tr><td><code>meshgrid</code></td><td>Rectangular grid in 2-D and 3-D space</td></tr>
<tr><td><code>ndgrid</code></td><td>Rectangular grid in N-D space</td></tr>
<tr><td><code>permute</code></td><td>Rearrange dimensions of N-D array</td></tr>
<tr><td><code>prod</code></td><td>Product of array elements</td></tr>
<tr><td><code>repmat</code></td><td>Repeat copies of array</td></tr>
<tr><td><code>reshape</code></td><td>Reshape array</td></tr>
<tr><td><code>shiftdim</code></td><td>Shift dimensions</td></tr>
<tr><td><code>sort</code></td><td>Sort array elements</td></tr>
<tr><td><code>squeeze</code></td><td>Remove singleton dimensions</td></tr>
<tr><td><code>sub2ind</code></td><td>Convert subscripts to linear indices</td></tr>
<tr><td><code>sum</code></td><td>Sum of array elements</td></tr>

</tbody>
</table>
<p><br /></p>

<h2 id="measuring-the-performance-of-your-matlab-functions-and-scripts">Measuring the performance of your MATLAB functions and scripts</h2>

<p>MATLAB has several built-in methods of timing how long it takes to run a MATLAB function or script. The <code>timeit()</code> function as well as <code>tic</code> and <code>toc</code>, are in particular very useful. Use the <code>timeit()</code> function for a rigorous measurement of your function’s execution time. Use <code>tic</code> and <code>toc</code> to estimate time for smaller portions of code that are not complete functions.</p>

<p>For additional details about the performance of your code, such as function call information and execution time of individual lines of code, MATLAB has more sophisticated tools such as <em>MATLAB® Profiler</em>.</p>

<h3 id="timing-matlab-functions">Timing MATLAB functions</h3>

<p>To measure the time required to run a function, whether built-in or your own, you can use the <code>timeit()</code> function. The <code>timeit()</code> function calls the user-specified function multiple times, and returns the median of the time measurements. This function takes <strong>a handle to the function whose performance is to be measured</strong> and returns the typical execution time, in seconds.</p>

<p>For example, suppose that you want to measure the performance of MATLAB’s built-in function, <code>isprime()</code> for a given input value to this function. You can compute the time to execute the function using <code>timeit()</code> like the following,</p>

<pre><code class="language-matlab">&gt;&gt; timeit( @()isprime(10^14) ) % pass the function as a handle to timeit()
ans =
    0.0787
</code></pre>
<p><br />
Note that, this function <code>isprime()</code> will have different performance given different input numbers,</p>
<pre><code class="language-matlab">&gt;&gt; timeit( @()isprime(10^4) ) % pass the function as a handle to timeit()
ans =
   2.0402e-05
</code></pre>
<p><br /></p>

<h3 id="time-portions-of-code">Time Portions of Code</h3>

<p>To estimate how long a portion of your program takes to run or to compare the speed of different implementations of portions of your program, you can use MATLAB stopwatch timer functions: <code>tic</code> and <code>toc</code>. Invoking <code>tic</code> starts the timer, and the next <code>toc</code> reads the elapsed time.</p>

<pre><code class="language-matlab">tic
   % The program section to time. 
toc
</code></pre>
<p><br />
Sometimes programs run too fast for <code>tic</code> and <code>toc</code> to provide useful data. If your code is faster than <strong>1/10 second</strong>, consider timing it while running in a loop, and then average the result to find the time for a single run of the loop.</p>

<h4 id="the-cputime-function-vs-tictoc-and-timeit">The <code>cputime()</code> function vs. <code>tic/toc</code> and <code>timeit()</code></h4>

<p>There is another MATLAB function that can do timing of your scripts or your functions: The <code>cputime()</code> function measures the total CPU time and <strong>sums across all threads (cores) in the CPU</strong>. This measurement is different from the <strong>wall-clock time</strong> that <code>timeit()</code> or <code>tic/toc</code> return, and could be misleading. For example, the CPU time for the pause function is typically small, but the wall-clock time accounts for the actual time that MATLAB execution is paused. Therefore, the wall-clock time might be longer.</p>

<p>If your function uses four processing cores equally, the CPU time could be approximately four times higher than the wall-clock time.</p>

<p>Frequently, your best choice to measure the performance of your code is <code>timeit()</code> or <code>tic</code> and <code>toc</code>. These functions return wall-clock time. Note that, unlike <code>tic</code> and <code>toc</code>, the <code>timeit()</code> function calls your code multiple times, and, therefore, considers the cost of first-time calls to your functions, which are typically more time-consuming than subsequent calls.</p>

<h3 id="some-tips-for-measuring-performance">Some tips for Measuring Performance</h3>

<ul>
  <li>Always time a <strong>significant enough</strong> portion of code. Normally, the code that you are timing should <strong>take more than 1/10 second to run</strong>, otherwise the timing may not be very accurate.<br />
<br /></li>
  <li>Put the code you are trying to time into a function instead of timing it at the command line or inside a script.<br />
<br /></li>
  <li>Unless you are trying to measure <strong>first-time cost of running your code</strong>, run your code multiple times. Use the <code>timeit()</code> function for multiple calls timing of your function.<br />
<br /></li>
  <li>Avoid <code>clear all</code> when measuring performance of your MATLAB scripts. This will add additional time to wipe MATLAB workspace from all current existing variable definitions, and therefore contaminate the timing measurements of the actual code in your MATLAB scripts.<br />
<br /></li>
  <li>When performing timing measurements, assign your output to a variable instead of letting it default to <code>ans()</code>.</li>
</ul>

<p><br /><br /></p>

            </div>
        </article>
        <div class="cf"></div>
<div class="row text-center">
    <section class="notepad-post-share">
        <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Lecture 10: MATLAB - loops and vectorization&quot;%20/ICP2017F/lecture/10-matlab-loops-vectorization%20via%20&#64;AmirShahmoradi"
            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
            <i class="fa fa-twitter"></i>
        </a>
        <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=/ICP2017F/lecture/10-matlab-loops-vectorization"
            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
            <i class="fa fa-facebook"></i>
        </a>
        <a class="google-icon" href="https://plus.google.com/share?url=/ICP2017F/lecture/10-matlab-loops-vectorization"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
            <i class="fa fa-google-plus"></i>
        </a>
    </section>
</div>
        <div class="cf"></div>
        
<div class="notepad-author-info">
    <div class="row">
        <section class="notepad-post-author small-12 columns">
            <a href="http://www.shahmoradi.org" target="_blank">
                <img src="/ICP2017F/images/logo.png" class="notepad-post-author-avatar" alt="Amir Shahmoradi's photo">
            </a>
            <span class="author-label">Author</span>
            <h1>Amir Shahmoradi</h1>
            <p><a href="mailto:amir@ices.utexas.edu" class="author-website">amir@ices.utexas.edu</a></p>
            <p>Genius is 99% perspiration and 1% inspiration</p>
        </section>
    </div>
</div> 
        
        <div class="cf"></div>
        
        <section class="notepad-disqus row">
    <div class="small-12 columns">
        <h1 class="notepad-comments-header">Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'shahmoradi'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</section>

        <div class="cf"></div>

    <footer class="notepad-site-footer">
    <div class="copyright">
         <!-- <section>Last updated 2017 / 10 / 29</section></br> -->
         <section>Last updated Sunday, 29 Oct 2017 at 01:49 PM CST</section></br>
         <section>All content exclusively maintained by <a href="http://shahmoradi.org" target="_blank">Amir Shahmoradi</a> <!-- &copy;--> </section></br>
         <section><a class="icon-ghost" href="http://www.ae.utexas.edu/" target="_blank">Department of Aerospace Engineering and Engineering Mechanics</a></section></br>
         <section><a class="icon-ghost" href="https://www.ices.utexas.edu/" target="_blank">Institute for Computational Engineering and Sciences | POB 6.328</a></section></br>
         <section><a class="icon-ghost" href="http://www.utexas.edu/" target="_blank">The University of Texas at Austin</a></section></br>
         <section>201 E 24th Street, Stop C0200</section></br>
         <section>Austin, TX 78712-1229</section>
    </div>
    <div class="social-icons">
        
        
        <a href="http://twitter.com/AmirShahmoradi" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
        
        
        <a href="http://github.com/shahmoradi" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
        
    </div>
    
    <div class="cf"></div>
</footer> 
</main>    
<!--dynamic page header-->
  <script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
  <script>window.jQuery || document.write('<script src="/ICP2017F/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
  <script src="/ICP2017F/assets/js/vendor/modernizr.js"></script>
  <script src="/ICP2017F/assets/js/foundation.min.js"></script>
  
  <script src="/ICP2017F/assets/js/notepad.js"></script>
  <script src="/ICP2017F/assets/js/scripts.min.js"></script>
  <script src="/ICP2017F/assets/js/vendor/nprogress.js"></script>
  
  <script>
    $(document).foundation();
  </script>
  <script type='text/javascript'>console.log("N/A");</script>
  <script type='text/javascript'>console.log("http://www.shahmoradi.org/");</script>

<!--header anchor links-->
<script src="/ICP2017F/assets/js/autoAnchorLink.js"></script>

<!-- <script src="/ICP2017F/assets/js/prismOkaidia.js"></script>
<script src="/ICP2017F/assets/js/prismTwilight.js"></script>
<script src="/ICP2017F/assets/js/prismDefault.js"></script>
 -->
<script src="/ICP2017F/assets/js/prismCoy.js"></script>

<!-- Start of Google Analytics Code for Default Guide -->
  <script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-67460905-1', 'auto');
    ga('send', 'pageview');
  </script>
<!-- End of Google Analytics Code for Default Guide -->
   
<!-- Start of StatCounter Code for Default Guide -->
  <script type="text/javascript">
    var sc_project=10611821; 
    var sc_invisible=1; 
    var sc_security="902e4bb4"; 
    var scJsHost = (("https:" == document.location.protocol) ?
    "https://secure." : "http://www.");
    document.write("<sc"+"ript type='text/javascript' src='" +
    scJsHost+
    "statcounter.com/counter/counter.js'></"+"script>");
    </script>
    <noscript><div class="statcounter"><a title="shopify visitor
    statistics" href="http://statcounter.com/shopify/"
    target="_blank"><img class="statcounter"
    src="http://c.statcounter.com/10611821/0/902e4bb4/0/"
    alt="shopify visitor statistics"></a></div></noscript>
<!-- End of StatCounter Code for Default Guide --> 
<!--automatic Table of Content.-->
<script src="/ICP2017F/assets/js/autoTOC.js"></script>
</body>
</html>
