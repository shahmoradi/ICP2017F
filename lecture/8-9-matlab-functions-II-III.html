<!DOCTYPE html>
<html>
<head>

<!--
<meta name="viewport" content="width=device-width, initial-scale=1">
<link rel="stylesheet" href="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.css">
<script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
<script src="https://code.jquery.com/mobile/1.4.5/jquery.mobile-1.4.5.min.js"></script>
<script src="/ICP2017F/assets/js/mdHeaderCollapse.js"></script>
-->

<meta charset="utf-8">
<title>LECTURE 8-9: MATLAB - FUNCTIONS II & III &vert; COE 301 - FALL 2017 - MWF 9-10 AM - UTC 4.110</title>
<meta name="description" content="Introduction to<br>Computer Programming">
<meta name="keywords" content="">

<!-- Twitter Cards -->
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="/ICP2017F/images/logo.png">
<meta name="twitter:title" content="Lecture 8-9: MATLAB - functions II & III">
<meta name="twitter:description" content="Introduction to<br>Computer Programming">
<meta name="twitter:creator" content="@AmirShahmoradi">

<!-- Open Graph -->
<meta property="og:locale" content="en_US">
<meta property="og:type" content="article">
<meta property="og:title" content="Lecture 8-9: MATLAB - functions II & III">
<meta property="og:description" content="Introduction to<br>Computer Programming">
<meta property="og:url" content="/ICP2017F/lecture/8-9-matlab-functions-II-III">
<meta property="og:site_name" content="COE 301 - Fall 2017 - MWF 9-10 AM - UTC 4.110">
<meta property="og:image" content="/ICP2017F/images/">





<link rel="canonical" href="/ICP2017F/lecture/8-9-matlab-functions-II-III">
<!-- <link href="/ICP2017F/feed.xml" type="application/atom+xml" rel="alternate" title="COE 301 - Fall 2017 - MWF 9-10 AM - UTC 4.110 Feed"> -->


<!-- http://t.co/dKP3o1e -->
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no" />

<link href='https://fonts.googleapis.com/css?family=Montserrat:400,700|Open+Sans:400,600,300,800,700' rel='stylesheet' type='text/css'>
<link rel="stylesheet" href="/ICP2017F/assets/css/vendor/font-awesome.min.css">
<link rel="stylesheet" href="/ICP2017F/assets/css/vendor/normalize.css">
<link rel="stylesheet" href="/ICP2017F/assets/css/vendor/nprogress.css">
<link rel="stylesheet" href="/ICP2017F/assets/css/vendor/foundation.min.css">
<link rel="stylesheet" href="/ICP2017F/assets/css/style.css">
<link rel="stylesheet" href="/ICP2017F/assets/css/post.css">

<!--Mathjax-->

<style TYPE="text/css">
code.has-jax {font: inherit; font-size: 100%; background: inherit; border: inherit;}
</style>
<script type="text/x-mathjax-config">
MathJax.Hub.Config({
    tex2jax: {
        inlineMath: [['$','$'], ['\\(','\\)']],
        skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'] // removed 'code' entry
    }
});
MathJax.Hub.Queue(function() {
    var all = MathJax.Hub.getAllJax(), i;
    for(i = 0; i < all.length; i += 1) {
        all[i].SourceElement().parentNode.className += ' has-jax';
    }
});
</script>
<script type="text/javascript" src="https://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

<!-- Icons -->
<link rel="shortcut icon" href="/ICP2017F/favicon.ico">

<!-- prism
<link href="/ICP2017F/assets/css/prismTwilight.css" rel="stylesheet" />
<link href="/ICP2017F/assets/css/prismDefault.css" rel="stylesheet" />
<link href="/ICP2017F/assets/css/prismCoy.css" rel="stylesheet" />
-->
<link href="/ICP2017F/assets/css/prismOkaidia.css" rel="stylesheet" />

<!--header anchor links-->
<link href="//netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css" rel="stylesheet">
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>

<style type="text/css">@media only screen and (min-width:43.75em){.notepad-post-content div>p:first-child:first-letter{float:left;font-size:4.688rem;line-height:4.375rem;padding-top:.25rem;padding-right:.5rem;padding-left:.188rem;font-family:serif}}</style>
</head>
<body class="post-template" itemscope itemtype="https://schema.org/WebPage">  

        <main id="notepad-post-container-simple" class="notepad-post-container-simple" role="main">
            <header class="notepad-post-header-simple">
                <div class="notepad-post-menu-header-simple">

                    <a class="notepad-blog-logo" href=https://www.cdslab.org target="_blank"><img src="/ICP2017F/images/logo.png" alt="cdslab.org" /></a>

                <div class="notepad-blog-menu">      
    <div class="notepad-mobile-menu show-for-small">
        <a href="#"><i class="fa fa-bars"></i></a>
    </div>
    <ul class="notepad-menu">
        <li class="notepad-mobile-close-btn show-for-small text-right">
            <a href="#"><i class="fa fa-times"></i></a>
        </li>

            <li>
                    <a href="/ICP2017F/">Home</a>
                 </li>

            <li>
                    <a href="/ICP2017F/highlights">Highlights</a>
                 </li>

            <li>
                    <a href="/ICP2017F/categories">Categories</a>
                 </li>

            <li>
                    <a href="/ICP2017F/about">About</a>
                 </li>
            
           <li><a href="/ICP2017F/feed.xml" title="Atom/RSS feed"><i class="icon-rss"></i> Feed</a></li>
    </ul>

</div>
            </div>

                <div class="notepad-post-title-simple row">
                    <div class="small-12 columns">
                        <div class="notepad-post-meta-simple">
                            <h2>Lecture 8-9: MATLAB - functions II & III</h2>
                            <p>by <strong>Amir Shahmoradi</strong> &#8212;  <strong><time datetime="2017-10-13T00:00:00-05:00">13 Oct 2017</time></strong></p>
                        </div>
                    </div>
                </div>
            </header>

        
            <article class="notepad-post-content post tag-simple">
        
            <div style="text-align:justify;">
                <p>This lecture further explains the concept of functions and different of types of it in MATLAB.</p>

<p><strong>Useful link:</strong> <a href="https://www.mathworks.com/help/matlab/functionlist.html" target="_blank">Comprehensive MATLAB function list</a></p>

<div class="post_toc"></div>

<h2 id="lecture-videos">Lecture Videos</h2>

<p>This video is created solely as reference for the attendants of ICP2017F course at UT Austin. If you did not attend this class, then you may not find this video useful.</p>

<div class="center"><div class="video-wrapper"><div class="video-container">
    <iframe width="853" height="480" src="https://www.youtube.com/embed/4Fx4ulZt0_c" frameborder="0" allowfullscreen=""></iframe>
</div></div></div>
<p><br /></p>

<div class="center"><div class="video-wrapper"><div class="video-container">
    <iframe width="853" height="480" src="https://www.youtube.com/embed/E674aXSMHJY" frameborder="0" allowfullscreen=""></iframe>
</div></div></div>
<p><br /></p>

<div class="center"><div class="video-wrapper"><div class="video-container">
    <iframe width="853" height="480" src="https://www.youtube.com/embed/a4qXf1czT_E" frameborder="0" allowfullscreen=""></iframe>
</div></div></div>
<p><br /></p>

<div class="center"><div class="video-wrapper"><div class="video-container">
    <iframe width="853" height="480" src="https://www.youtube.com/embed/m3QK91zKt4Q" frameborder="0" allowfullscreen=""></iframe>
</div></div></div>
<p><br /></p>

<h2 id="function-handles-in-matlab">Function handles in MATLAB</h2>

<p>Function Handles are variables that allow you to invoke a function indirectly. A <strong>function handle</strong> is a <strong>data type</strong> that <strong>stores an association to a function</strong>. For example, you can use a function handle to construct <a href="#anonymous-functions">anonymous functions</a> or specify <a href="https://www.mathworks.com/help/matlab/creating_plots/callback-definition.html" target="_blank">call-back functions</a>. Also, you can use a function handle to <strong>pass a function to another function</strong>, or call local functions from outside the main function (see below).</p>

<p>Indirectly calling a function enables you to invoke the function regardless of where you call it from. Typical uses of function handles include:</p>

<ul>
  <li>Pass a function to another function (often called <a href="#function-functions">function functions</a>). For example, passing a function to integration or optimization functions as we will see later in this course, such as <code>integral</code> and <code>fzero</code>.</li>
  <li>Construct handles to functions defined inline instead of stored in a program file (anonymous functions).</li>
  <li>Call <a href="#local-functions">local functions</a> from outside the main function.</li>
</ul>

<p>You can see if a variable, say <code>h</code>, is a function handle using <code>isa(h,'function_handle')</code>.</p>

<h3 id="creating-function-handle">Creating function handle</h3>

<p>The general method for creating a function handle is to precede the function name with an <code>@</code> sign. For example, if you have a function called <code>myfunc</code>, you can create a handle named <code>f</code> for it as follows,</p>
<pre><code class="language-matlab">f = @myfunc;
</code></pre>
<p><br />
For example,</p>
<pre><code class="language-matlab">function out = getSq(x)
    out = x.^2;
end
</code></pre>
<p><br />
Then you can create a function handle on MATLAB command line like the following,</p>
<pre><code class="language-matlab">&gt;&gt; f = @getSq;
&gt;&gt; a = 4;
&gt;&gt; b = f(a)
b =
    16
</code></pre>
<p><br />
If the function does not require any inputs, then you can call the function with empty parentheses. For example,</p>
<pre><code class="language-matlab">&gt;&gt; h = @ones;
&gt;&gt; a = h()
a =
     1
</code></pre>
<p><br />
If you don’t add <code>()</code> at the time of call, then simply another function handle will be created, now assigned to <code>a</code>,</p>
<pre><code class="language-matlab">&gt;&gt; h = @ones;
&gt;&gt; a = h
a = 
    @ones
&gt;&gt; class(a)
ans =
function_handle
</code></pre>
<p><br />
Function handles can be passed as variables to other functions. For example, to calculate the integral of $f(x)=x^2$, as implemented in <code>getSq()</code> above, on the range $[0,1]$ define,</p>
<pre><code class="language-matlab">&gt;&gt; f = @getSq; 
&gt;&gt; q = integral(f,0,1)
q =
    0.3333
</code></pre>
<p><br /></p>

<h3 id="arrays-of-function-handles">Arrays of function handles</h3>

<p>You can also create an array of function handles by collecting them into a cell or structure array. For example,</p>
<pre><code class="language-matlab">&gt;&gt; fset = {@sin, @cos, @tan, @cot};
&gt;&gt; fset{1}(pi)
ans =
   1.2246e-16
&gt;&gt; fset{2}(pi)
ans =
    -1
&gt;&gt; fset{3}(pi)
ans =
  -1.2246e-16
&gt;&gt; fset{4}(pi)
ans =
  -8.1656e+15
</code></pre>
<p><br />
To get general information about a function handle on MATLAB command line, use,</p>
<pre><code class="language-matlab">&gt;&gt; functions(fset{4})
ans = 
    function: 'cot'
        type: 'simple'
        file: ''
</code></pre>
<p><br /></p>

<h2 id="function-types-in-matlab">Function types in MATLAB</h2>

<p>There are several types of functions in MATLAB. These include:</p>

<ul>
  <li>local functions,</li>
  <li>nested functions,</li>
  <li>private functions,</li>
  <li>function functions,</li>
  <li>anonymous functions</li>
  <li>….</li>
</ul>

<h3 id="anonymous-functions">Anonymous functions</h3>

<p>Anonymous functions allow you to create a MATLAB file without the need to put the function in a separate <code>.m</code> file dedicated to the function. This function is associated with a variable whose data type is <strong>function_handle</strong>. Anonymous functions can accept inputs and return outputs, just as standard functions do. However, they can <strong>contain only a single executable statement</strong>. The concept of anonymous function is similar to <a href="https://www.programiz.com/python-programming/anonymous-function" target="_blank">lambda functions in Python</a>, if you are already familiar with this language. For example, consider the following handle to an anonymous function that finds the square of a number,</p>
<pre><code class="language-matlab">&gt;&gt; sq = @(x) x.^2;
&gt;&gt; sq(2)
ans =
     4
&gt;&gt; sq([2,3,4])
ans =
     4     9    16
</code></pre>

<h4 id="variables-in-the-anonymous-function-expressions">Variables in the anonymous function expressions</h4>

<p>Function handles can store not only an expression, but also variables that the expression requires for evaluation. For example, you can create a function handle to an anonymous function that requires coefficients <code>a</code>, <code>b</code>, and <code>c</code>.</p>
<pre><code class="language-matlab">&gt;&gt; a = 1.3;
&gt;&gt; b = .2;
&gt;&gt; c = 30;
&gt;&gt; parabola = @(x) a*x.^2 + b*x + c;
</code></pre>
<p><br />
Since <code>a</code>, <code>b</code>, and <code>c</code> are available at the time you create parabola, the function handle includes those values. The values persist within the function handle even if you clear the variables:</p>
<pre><code class="language-matlab">&gt;&gt; clear a b c
&gt;&gt; x = 1;
&gt;&gt; y = parabola(x)
y =
   31.5000
</code></pre>
<p><br />
But note that in order to supply different values for the coefficients, you must create a new (e.g., redefine the) function handle,</p>
<pre><code class="language-matlab">&gt;&gt; a = -3.9;
&gt;&gt; b = 52;
&gt;&gt; c = 0;
&gt;&gt; parabola = @(x) a*x.^2 + b*x + c;
&gt;&gt; x = 1;
&gt;&gt; y = parabola(x)
y =
   48.1000
</code></pre>
<p><br /></p>

<h4 id="multiple-nested-anonymous-functions">Multiple (nested) anonymous functions</h4>

<p>The expression in an anonymous function can include another anonymous function. This is useful for passing different parameters to a function that you are evaluating over a range of values. For example, suppose you want to solve the following equation for varying values of the variable <code>c</code>,</p>

<script type="math/tex; mode=display">g(c) = \int^1_0 \big( x^2 + cx + 1 \big) \operatorname{d}x</script>

<p>You can do so by combining two anonymous functions,</p>
<pre><code class="language-matlab">g = @(c) (integral(@(x) (x.^2 + c*x + 1),0,1));
</code></pre>
<p>Here are the steps to derive the above nested anonymous function:</p>
<ul>
  <li>Write the integrand as an anonymous function,
    <pre><code class="language-matlab">@(x) (x.^2 + c*x + 1)
</code></pre>
  </li>
  <li>Evaluate the function from zero to one by passing the function handle to integral,
    <pre><code class="language-matlab">integral(@(x) (x.^2 + c*x + 1),0,1)
</code></pre>
  </li>
  <li>Supply the value for c by constructing an anonymous function for the entire equation,
    <pre><code class="language-matlab">g = @(c) (integral(@(x) (x.^2 + c*x + 1),0,1));
</code></pre>
  </li>
</ul>

<p>The final function allows you to solve the equation for any value of <code>c</code>. For example,</p>
<pre><code class="language-matlab">&gt;&gt; g(10)
ans =
    6.3333
</code></pre>
<p><br /></p>

<h4 id="anonymous-functions-with-no-input">Anonymous functions with no input</h4>

<p>If your function does not require any inputs, use empty parentheses when you define and call the anonymous function. Otherwise, as stated above in <a href="#function-handles">function handles</a>, you will simply create a new function handle. For example,</p>
<pre><code class="language-matlab">&gt;&gt; t = @() datestr(now);
&gt;&gt; d = t()
d =
23-May-2017 19:54:07
</code></pre>
<p><br />
and omitting the parentheses in the assignment statement creates another function handle, and does not execute the function,</p>
<pre><code class="language-matlab">&gt;&gt; d = t
d = 
    @()datestr(now)
</code></pre>
<p><br /></p>

<h4 id="anonymous-functions-with-multiple-inputs-or-outputs">Anonymous functions with multiple inputs or outputs</h4>

<p>Anonymous functions require that you explicitly specify the input arguments, as many as it may be, just the way you would for a standard function, separating multiple inputs with commas. For example, the following function accepts two inputs, <code>x</code> and <code>y</code>,</p>
<pre><code class="language-matlab">&gt;&gt; myfunc = @(x,y) (x^2 + y^2 + x*y);
&gt;&gt; x = 1;
&gt;&gt; y = 10;
&gt;&gt; z = myfunc(x,y)
z =
   111
</code></pre>
<p><br />
However, you do not explicitly define output arguments when you create an anonymous function. If the expression in the function returns multiple outputs, then you can request them when you call the function. In that case, you should enclose multiple output variables in square brackets <code>[]</code>. For example, MATLAB’s <code>ndgrid</code> function can return as many outputs as the number of input vectors. This anonymous function that calls <code>ndgrid</code> can also return multiple outputs:</p>
<pre><code class="language-matlab">mygrid = @(x,y,c) ndgrid((-x:x/c:x),(-y:y/c:y));
[X,Y] = mygrid(pi,2*pi,10);
</code></pre>
<p><br />
You can use the output from <code>mygrid</code> to create a mesh or surface plot, like the following, as we will further discuss in future lectures on plotting in MATLAB,</p>
<pre><code class="language-matlab">Z = sin(X) + cos(Y);
mesh(X,Y,Z)
</code></pre>

<figure>
	<img src="/ICP2017F/lecture/8-9/mesh.png" width="800" />
</figure>

<h4 id="arrays-of-anonymous-functions">Arrays of anonymous functions</h4>

<p>As we did above for MATLAB <a href="#arrays-of-function-handles">function handles</a>, you can also store multiple anonymous functions in a cell array or structure array. The most common approach is to use a cell array, like the following,</p>
<pre><code class="language-matlab">f = {@(x)x.^2;
     @(y)y+10;
     @(x,y)x.^2+y+10
     };
</code></pre>
<p><br />
When you create the cell array, <strong>keep in mind</strong> that <strong>MATLAB interprets spaces as column separators for the cell array</strong>. Either omit spaces from expressions, as shown in the previous code, or enclose expressions in parentheses, such as</p>
<pre><code class="language-matlab">f = {@(x) (x.^2);
     @(y) (y + 10);
     @(x,y) (x.^2 + y + 10)
     };
</code></pre>
<p><br />
Access the contents of a cell using curly braces. For example, f{1} returns the first function handle. To execute the function, pass input values in parentheses after the curly braces:</p>
<pre><code class="language-matlab">&gt;&gt; x = 1;
&gt;&gt; y = 10;
&gt;&gt; f{1}(x)
ans =
     1
&gt;&gt; f{2}(y)
ans =
    20
&gt;&gt; f{3}(x,y)
ans =
    21
</code></pre>
<p><br /></p>

<h3 id="local-functions">Local functions</h3>

<p>MATLAB program files can contain code for more than one function. In a function file, the first function in the file is called the <strong>main function</strong>. This function is <strong>visible to functions in other files</strong>, or you can call it from the command line. Additional functions within the file are called <strong>local functions</strong>, and they can occur in any order after the main function. Local functions are <strong>only visible to other functions in the same file</strong>. They are equivalent to subroutines in other programming languages, and are <strong>sometimes called subfunctions</strong>.</p>

<p>As of R2016b, you can also create local functions in a script file, as long as they all appear after the last line of script code. For more information, see <a href="https://www.mathworks.com/help/matlab/matlab_prog/local-functions-in-scripts.html" target="_blank">here</a>.</p>

<p><strong>Exercise:</strong><br />
Create a function file named <code>mystats.m</code> that takes as input a given vector of real numbers, and outputs the mean and median of the vector. The <code>.m</code> file for this function should contain contains a main function <code>mystats()</code>, and two local functions, <code>mymean</code> and <code>mymedian</code>. Test your main function using an input vector like,</p>
<pre><code class="language-matlab">&gt;&gt; myvec = [10:3:100];
&gt;&gt; mystats(myvec)
ans =
    55
</code></pre>
<p><br /></p>

<!--
**Answer:**  
```matlab
function [avg, med] = mystats(x)
    n = length(x);
    avg = mymean(x,n);
    med = mymedian(x,n);
end

function a = mymean(v,n)
    % MYMEAN Example of a local function.
    a = sum(v)/n;
end

function m = mymedian(v,n)
    % MYMEDIAN Another example of a local function.
    
    w = sort(v);
    if rem(n,2) == 1
        m = w((n + 1)/2);
    else
        m = (w(n/2) + w(n/2 + 1))/2;
    end
end
```
<br>
Note that you cannot call the local functions, because local functions are not visible to any other place or function in MATLAB other than `mystats()`.  
```matlab
>> mymean(myvec,length(myvec))
Undefined function or variable 'mymean'. 
Did you mean:
>> mean(myvec,length(myvec))
```
<br>
-->

<h4 id="collective-function-handle-for-all-local-functions">Collective function handle for all local functions</h4>

<p>MATLAB has a built-in function <code>localfunctions</code> that returns a cell array of all local functions in the scope of the current function or script (i.e., in the current MATLAB file). This is very useful, when you want to write a function that returns to the main program, a list of functions local to this function. For example,</p>
<pre><code class="language-matlab">function fh = computeEllipseVals
    fh = localfunctions;
end

function f = computeFocus(a,b)
    f = sqrt(a^2-b^2);
end

function e = computeEccentricity(a,b)
    f = computeFocus(a,b);
    e = f/a;
end

function ae = computeArea(a,b)
    ae = pi*a*b;
end
</code></pre>
<p><br />
Now, if you call <code>computeEllipseVals</code> on the command prompt, you will get a cell array to all functions local to <code>computeEllipseVals</code>,</p>
<pre><code class="language-matlab">&gt;&gt; fhcell = computeEllipseVals
ans = 
    @computeFocus       
    @computeEccentricity
    @computeArea
&gt;&gt; fhcell{3}(1,1) % get the area of an ellipse with semi-axes (1,1).
ans =
    3.1416
</code></pre>
<p><br /></p>

<h3 id="function-functions">Function functions</h3>

<p>Function-functions are functions that operate on other functions that are passed to it as input arguments. The function that is passed to the function-function is usually referred to as <em>passed function</em>. A simple example is MATLAB’s built-in function <code>fplot(func,lim)</code>, which plots the given input function <code>func</code> to it within the limit <code>lim</code>,</p>
<pre><code class="language-matlab">fplot(@sin,[-2*pi 2*pi])
</code></pre>
<figure>
	<img src="/ICP2017F/lecture/8-9/sin.png" width="700" />
</figure>

<h3 id="nested-functions">Nested functions</h3>

<p>Nested functions, as implicitly described by their names, are completely contained within a parent function. Any function in a program file can include a nested function. For example, consider the following simple function <code>nestedfunc()</code> inside of its parent function <code>parent()</code>:</p>
<pre><code class="language-matlab">function parent
    disp('This is the parent function')
    nestedfunc
    function nestedfunc
       disp('This is the nested function')
    end
end
</code></pre>
<pre><code class="language-matlab">&gt;&gt; parent
This is the parent function
This is the nested function
</code></pre>
<p><br />
The primary difference between nested functions and other types of functions is that they can <strong>access and modify variables that are defined in their parent functions</strong>. Therefore, nested functions can use variables that are not explicitly passed as input arguments. In a parent function, you can create a handle to a nested function that contains the data necessary to run the nested function.</p>

<p><strong>Requirements for Nested Functions</strong>:</p>
<ul>
  <li>Although MATLAB functions do not typically require an <code>end</code> statement, in order to nest any function in a program file, all functions in that file <strong>must use an <code>end</code> statement</strong>.<br />
<br /></li>
  <li>You cannot define a nested function inside any of the MATLAB program control statements, such as <code>if/elseif/else</code>, <code>switch/case</code>, <code>for</code>, <code>while</code>, or <code>try/catch</code>.<br />
<br /></li>
  <li>You must call a nested function either directly by name (without using <code>feval</code>), or using a function handle that you created using the <code>@</code> operator (and not <code>str2func</code>).<br />
<br /></li>
  <li>All of the variables in nested functions or the functions that contain them must be explicitly defined. That is, you cannot call a function or script that assigns values to variables unless those variables already exist in the function workspace.<br />
<br /></li>
  <li>In general, variables in one function workspace are not available to other functions. However, <strong>nested functions can access and modify variables in the workspaces of the functions that contain them</strong>. This means that both a nested function and the parent function that contains it can modify the same variable without passing that variable as an argument. For example, in each of these functions, <code>main1()</code> and <code>main2</code>, both parent functions and the nested functions can access variable <code>x</code>,<br />
<br />
    <pre><code class="language-matlab">function main1
  x = 5;
  nestfun1
  function nestfun1 
      x = x + 1;
  end
  disp(['x = ',num2str(x)])
end
</code></pre>
    <pre><code class="language-matlab">function main2
  nestfun2
  function nestfun2
      x = 5;
  end 
  x = x + 1;
  disp(['x = ',num2str(x)])
end
</code></pre>
    <pre><code class="language-matlab">&gt;&gt; main1
x = 5
&gt;&gt; main1()
x = 6
&gt;&gt; main2()
x = 6
</code></pre>
    <p><br />
When the parent function does not use a given variable, the variable remains local to the nested function. This is rather subtle and complicated. So pay attention. For example, in this function named main, the two nested functions have their own versions of <code>externFunc</code> that cannot interact with each other, and calling <code>main</code>, gives a syntax error in <code>nestedfun2</code>, since <code>myvar</code></p>
    <pre><code class="language-matlab">function main
  nestedfun1
  nestedfun2
  function nestedfun1
      myvar = 10;
      xyz = 5;
  end
  function nestedfun2
      myvar = myvar + 2;
  end
end
</code></pre>
    <pre><code class="language-matlab">&gt;&gt; main
Undefined function or variable 'myvar'.
Error in main/nestedfun2 (line 10)
      myvar = myvar + 2;
Error in main (line 3)
  nestedfun2
</code></pre>
    <p><br />
However, even the slightest mention of the variable <code>myvar</code>, like the following, makes it accessible in the scope of both main and nested functions.</p>
    <pre><code class="language-matlab">function main
  nestedfun1
  nestedfun2
    
  function nestedfun1
      myvar = 10;
  end

  function nestedfun2
      myvar = myvar + 2;
  end
  disp(['myvar = ',num2str(myvar)]);
  disp(['class(myvar) = ',class(myvar)]);
end
</code></pre>
    <pre><code class="language-matlab">&gt;&gt; main
myvar = 12
class(myvar) = double
</code></pre>
    <p><br />
However, if there is any other function in MATLAB path that has the same name as this variable <code>myvar</code>, then MATLAB by default will call the function, instead of invoking the value for this variable given by the nested functions. For example if the following function is in MATLAB path,</p>
    <pre><code class="language-matlab">function result = myvar
  result = -13;
end
</code></pre>
    <p><br />
then calling the same function <code>main</code> as above would give,</p>
    <pre><code class="language-matlab">&gt;&gt; main
myvar = -13
class(myvar) = double
</code></pre>
    <p><br />
The scope of variables in MATLAB functions, especially nested functions, can become a significant source of error and confusion in your MATLAB code, if you are not careful. As a result, MATLAB’s code editor, has special syntax-highlighting features for variables that are shared between nested functions, and is very smart in automatically detecting syntax or semantic errors in your codes. So, I always recommend you to use MATLAB’s own editor and debugger. You can find more information about this issue <a href="https://www.mathworks.com/help/matlab/matlab_prog/check-variable-scope-in-editor.html" target="_blank">here</a>.</p>
  </li>
</ul>

<h3 id="private-functions">Private Functions</h3>

<p>A typical modern MATLAB contains thousands of M-files on the user’s path, all
accessible just by typing the name of the M-file. While this ease of accessing M-files is
an advantage, it can lead to clutter and clashes of names, not least due to the presence
of “helper functions” that are used by other functions but not intended to be called
directly by the user. Private functions provide an elegant way to avoid these problems.
Any functions residing in a directory called private are visible only to functions in
the parent directory. They can therefore have the same names as functions in other
directories. When MATLAB looks for a function it searches subfunctions, then private
functions (relative to the directory in which the function making the call is located),
then the current directory and the path. Hence if a private function has the same
name as a nonprivate function (even a built-in function), the private function will be
found first.</p>

<h3 id="recursive-functions">Recursive functions</h3>

<p>In programming, a recursive function is a function that calls itself. Recursion is needed frequently in programming, although there might be better, more efficient ways of implementing many of the simple explanatory recursion examples that you find in programming books. A prominent and sometimes more efficient alternative to <strong>recursive programming</strong> is <strong>iterative methods</strong> (e.g., loops and vectorization, which is the topic of the next lecture). Nontrivial examples that require recursive programming are abundant, but go beyond the scope of this course. Ask me in person and I will give you some examples from my own research.</p>

<p>To begin, let’s write a simple function that takes in one positive integer $n$, and calculates its factorial,</p>

<script type="math/tex; mode=display">n! = n \times (n-1) \times \cdots \times 1 ~.</script>

<pre><code class="language-matlab">function result=getFactorial(x)
    if (x&lt;=0)
        result=1;
    else
        result=x*getFactorial(x-1);
    end
end
</code></pre>
<pre><code class="language-matlab">&gt;&gt; getFactorial(3)
ans =
     6
</code></pre>
<p><br /></p>

<p><strong>Exercise:</strong><br />
Consider the MATLAB intrinsic function <a href=""><code>strtok</code></a>, which returns the first token (word) in a given string (sentence). Now, write a recursive MATLAB function that reverses the input sentence given by the user like the following,</p>
<pre><code class="language-matlab">&gt;&gt; reverseSentence('MATLAB is a rather strange but very powerful programming language')
</code></pre>
<pre><code>language programming powerful very but strange rather a is MATLAB 
</code></pre>

<p><strong>Answer:</strong></p>
<pre><code class="language-matlab">function reverseSentence(string)
    % reverseSentence recursively prints the words in a string in reverse order    
    getToken(string)
    function getToken(string)
        [word, rest] = strtok(string);
        if ~isempty(rest)
            getToken(rest);
        end
        fprintf([word,' '])
    end
    fprintf('\n')
end
</code></pre>

<h2 id="matlabs-intrinsic-functions">MATLAB’s intrinsic functions</h2>

<p>You may have already notices that functions are among the most useful concepts in programming. In fact, MATLAB owes its popularity to more 10000 built-in functions that contains,  and the number is growing every year. That means we don’t need to write programs for more than 10000 important general tasks that we may need to do everyday, for example, integration, differentiation, various types of plotting, root finding and many more.</p>

<p>A comprehensive list of MATLAB’s built-in functions is available in <a href="https://www.mathworks.com/help/matlab/functionlist.html" target="_blank">MATLAB manual</a>. I recommend you to bookmark this link on your personal computer, in order to get help from it whenever you need. As reminder, the following list contains some useful MATLAB functions, some of which we also discussed in the previous sections. Search for their cool functionalities in MATLAB manual!</p>
<ul>
  <li><code>doc</code></li>
  <li><code>func2str</code></li>
  <li><code>str2func</code></li>
  <li><code>fplot</code></li>
  <li><code>feval</code></li>
  <li><code>fzero</code></li>
  <li><code>which</code></li>
  <li><code>edit</code></li>
  <li><code>type</code></li>
</ul>

<p>Note that you can use the first one (<code>doc</code>) to view the information all the rest, even itself!</p>

<h2 id="scope-of-variables-in-matlab">Scope of variables in MATLAB</h2>

<p><strong>Variable scope</strong> refers to the extent of the code in which a variable can be referenced, accessed or modified, without resulting in an access error. We have already discussed that variables inside functions are local to the functions and not visible to other functions in MATLAB.  Variables defined inside a function are called <strong>local variables</strong>. They reside in the corresponding <strong>workspaces</strong> of the functions. The scope of <strong>local variables</strong> and <strong>dummy arguments</strong> is <strong>limited to the function</strong> (that is, to their workspace) in which they are defined. If the function contains nested functions, the code in the nested functions can access all variables defined in their parent function.</p>

<p>Occasionally it is convenient to create variables that exist in more than one workspace including, possibly, the main workspace. This can be done using the global statement. Variables stored in the <strong>MATLAB workspace</strong> (i.e., <strong>global memory</strong>) are called <strong>global variables</strong>.</p>

<h3 id="global-vs-local-variables">Global vs local variables</h3>

<p>Frequently, we need data (variable) protection (encapsulation) provided by local variables defined inside functions. In general, <strong>you should always do your best to avoid using global variables everywhere in your codes as much as possible</strong>. For small projects and problems, this may not be a significant issue. However, in large scale problems, the use of global variables can cause significant confusion, poor efficiency of your code, and even wrong results!</p>

<p>Occasionally, it may be useful to access global variables from within a function, for example,  when the global variables contain large amounts of data and passing them to through the function arguments may lead to significant consumption of computer memory and time.</p>

<h3 id="global-variable-usage-syntax">Global variable usage syntax</h3>

<ul>
  <li>To access a global variable from within a function, one should explicitly label the variable as <code>global</code>.</li>
  <li>A global variable must be declared global before it is used the first time in a function.</li>
  <li>Global variable declarations should be placed at the beginning of a function definition.</li>
  <li>For making a variable global in MATLAB’s base workspace, you should also first declare it as global.</li>
</ul>

<p>For example, consider the following code,</p>
<pre><code class="language-matlab">function setGlobalx(val)
    global x
    x = val;
end
</code></pre>
<p><br /></p>
<pre><code class="language-matlab">&gt;&gt; setGlobalx(10)
&gt;&gt; x
Undefined function or variable 'x'. 
</code></pre>
<p><br />
The problem here is that <code>x</code> is not declared as global in MATLAB’s base workspace. To do so,</p>
<pre><code class="language-matlab">&gt;&gt; global x
&gt;&gt; setGlobalx(10)
&gt;&gt; x
x =
    10
</code></pre>
<p><br />
<strong>Exercise</strong>:<br />
Consider the same <code>reverseSentence</code> function that we discussed above, but this time instead of giving it an input argument, we want to use a global variable string from MATLAB’s base workspace. How would you implement this, such that the following commands lead to the same output from the new global function?</p>
<pre><code class="language-matlab">&gt;&gt; global globalString
&gt;&gt; globalString = 'MATLAB is a rather strange but very powerful programming language';
&gt;&gt; reverseSentenceGlobal()
language programming powerful very but strange rather a is MATLAB 
</code></pre>
<p><br /></p>

<!--
**Answer:**  
```matlab
function reverseSentenceGlobal()
    % reverseSentence recursively prints the words in a string in reverse order
    global globalString
    getToken(globalString)
    function getToken(string)
        [word, rest] = strtok(string);
        if ~isempty(rest)
            getToken(rest);
        end
        fprintf([word,' '])
    end
    fprintf('\n')
end
```
-->
<p><br /></p>

<h3 id="persistent-variables">persistent variables</h3>

<p>Sometimes you may need to keep a variable inside a function local, but still you want the variable to retain its value from the last call of the function in the most recent function call. This is very useful, in particular makes your code immune to pitfalls of declaring variables <code>global</code>. The way to it is through the use of <code>persistent</code> attribute.</p>

<p>When you declare a variable within a function as persistent, the variable retains its value from one function call to the next. Other local variables retain their value only during the current execution of a function. Persistent variables are equivalent to static variables in other programming languages. Like <code>global</code> attribute inside functions, you have to declare variables using the <code>persistent</code> keyword before you use them inside the function. For example, consider the following function that adds an input value to some older value that already exists in the function from the old calls. If it is the first function call, then simply the input value is returned.</p>
<pre><code class="language-matlab">function result = findSum(inputvalue)
    persistent summ
    if isempty(summ)
    summ = 0;
    end
    summ = summ + inputvalue;
    result = summ;
end
</code></pre>
<pre><code class="language-matlab">&gt;&gt; findSum(10)
ans =
    10
&gt;&gt; findSum(10)
ans =
    20
&gt;&gt; findSum(10)
ans =
    30
</code></pre>
<p><br />
In order to clean the workspace of the function from these persistent variables, either of the two following methods work,</p>
<pre><code class="language-matlab">    clear all % dangerous! clears all objects in the MATLAB workspace.
    clear &lt;functionName&gt; % clears only this specific function's workspace
</code></pre>
<p><br />
To prevent clearing persistent variables, lock the function file using mlock.</p>

<p><a href="https://www.mathworks.com/help/matlab/matlab_prog/variables-in-nested-and-anonymous-functions.html" target="_blank">Here</a> are some advanced general advice by MATLAB developers on defining new variables and the scope of variables in MATLAB functions.</p>

<h2 id="matlab-functions-vs-matlab-scripts">MATLAB functions vs. MATLAB scripts</h2>

<p>MATLAB scripts are m-files containing MATLAB statements. MATLAB <code>functions</code> are another type of m-file, which were comprehensively discussed above. The biggest difference between scripts and functions are,</p>
<ul>
  <li>functions can have input and output parameters. Script files can only operate on the variables that are hard-coded into their m-file.<br />
<br /></li>
  <li>functions much more flexible than scripts. They are therefore more suitable for general purpose tasks, or for writing a scientific software. Scripts are useful for tasks that don’t change. They are also a way to document a specific sequence of actions, say a function call with special parameter values, that may be hard to remember.<br />
<br /></li>
  <li>A script can be thought of as a keyboard macro: when you type the name of the script, all of the commands contained in it are executed just as if you had typed these commands into the command window. Thus, all variables created in the script are added to the workspace for the current session. Also, if any of the variables in the script file have the same name as the ones in your current workspace, the values of those variables in the workspace are changed by the actions in the script. This can be used to your advantage. It can also cause unwanted <a href="https://en.wikipedia.org/wiki/Side_effect_(computer_science)" target="_blank">side-effects</a>. In contrast, function variables are local to the function. (with the exception that you could declare and use global variables with explicit <code>global</code> attribute.) The local scope of function variables gives you greater security and flexibility. To summarize, the workspace of MATLAB scripts is the base MATLAB workspace, whereas functions, have their own individual workspaces.<br />
<br /></li>
</ul>

<p><br /><br /></p>

            </div>
        </article>
        <div class="cf"></div>
<div class="row text-center">
    <section class="notepad-post-share">
        <a class="twitter-icon" href="https://twitter.com/intent/tweet?text=&quot;Lecture 8-9: MATLAB - functions II & III&quot;%20/ICP2017F/lecture/8-9-matlab-functions-II-III%20via%20&#64;AmirShahmoradi"
            onclick="window.open(this.href, 'twitter-share', 'width=550,height=235');return false;" title="Share on Twitter">
            <i class="fa fa-twitter"></i>
        </a>
        <a class="facebook-icon" href="https://www.facebook.com/sharer/sharer.php?u=/ICP2017F/lecture/8-9-matlab-functions-II-III"
            onclick="window.open(this.href, 'facebook-share','width=580,height=296');return false;" title="Share on Facebook">
            <i class="fa fa-facebook"></i>
        </a>
        <a class="google-icon" href="https://plus.google.com/share?url=/ICP2017F/lecture/8-9-matlab-functions-II-III"
           onclick="window.open(this.href, 'google-plus-share', 'width=490,height=530');return false;" title="Share on Google+">
            <i class="fa fa-google-plus"></i>
        </a>
    </section>
</div>
        <div class="cf"></div>
        
<div class="notepad-author-info">
    <div class="row">
        <section class="notepad-post-author small-12 columns">
            <a href=https://www.shahmoradi.org target="_blank">
                <img src="/ICP2017F/images/AmirShahmoradi.png" class="notepad-post-author-avatar" alt="Amir Shahmoradi's photo">
            </a>
            <span class="author-label">Author</span>
            <h1>Amir Shahmoradi</h1>
            <p><a href="mailto:shahmoradi@utexas.edu" class="author-website">shahmoradi@utexas.edu</a></p>
            <p>Genius is 99% perspiration and 1% inspiration</p>
        </section>
    </div>
</div> 
        
        <div class="cf"></div>
        
        <section class="notepad-disqus row">
    <div class="small-12 columns">
        <h1 class="notepad-comments-header">Comments</h1>
        <div id="disqus_thread"></div>
        <script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'shahmoradi'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function () {
        var s = document.createElement('script'); s.async = true;
        s.type = 'text/javascript';
        s.src = '//' + disqus_shortname + '.disqus.com/count.js';
        (document.getElementsByTagName('HEAD')[0] || document.getElementsByTagName('BODY')[0]).appendChild(s);
    }());
</script>
<noscript>Please enable JavaScript to view the <a href="https://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
    </div>
</section>

        <div class="cf"></div>

    <footer class="notepad-site-footer">
    <div class="copyright">
         <!-- <section>Last updated 2019 / 07 / 15</section></br> -->
         <section>Last updated Monday, 15 Jul 2019 at 05:19 PM CST</section></br>
         <section>All content exclusively maintained by <a href=https://www.shahmoradi.org target="_blank">Amir Shahmoradi</a> <!-- &copy;--> </section></br>
         <section><a class="icon-ghost" href="https://www.ae.utexas.edu/" target="_blank">Department of Aerospace Engineering and Engineering Mechanics</a></section></br>
         <section><a class="icon-ghost" href="https://www.ices.utexas.edu/" target="_blank">Institute for Computational Engineering and Sciences | POB 6.328</a></section></br>
         <section><a class="icon-ghost" href="https://www.utexas.edu/" target="_blank">The University of Texas at Austin</a></section></br>
         <section>201 E 24th Street, Stop C0200</section></br>
         <section>Austin, TX 78712-1229</section>
    </div>
    <div class="social-icons">
        
        
        <a href="https://twitter.com/AmirShahmoradi" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-twitter fa-stack-1x"></i>
            </span>
        </a>
        
        
        
        
        <a href="https://github.com/shahmoradi" target="_blank">
            <span class="fa-stack fa-lg">
                <i class="fa fa-circle fa-stack-2x fa-inverse"></i>
                <i class="fa fa-github fa-stack-1x"></i>
            </span>
        </a>
        
        
        <!-- Start of statc -->
        <div style="color: #000000; float: none; width: 100%; padding-top: 1rem;">
            <span style="font-size:0.8em">visitor count: 
                <script type="text/javascript">
                var sc_project=11495316; 
                var sc_invisible=0; 
                var sc_security="70939fec"; 
                var sc_text=3; 
                var scJsHost = (("https:" == document.location.protocol) ? "https://secure." : "http://www.");
                document.write("<sc"+"ript type='text/javascript' src='" +scJsHost+"statcounter.com/counter/counter.js'></"+"script>");
                </script>
            </span>
        </div>
        <!-- End of statc -->
    </div>
    <div class="cf"></div>
</footer> 
</main>    
<!--dynamic page header-->
<script src="//ajax.googleapis.com/ajax/libs/jquery/1.11.0/jquery.min.js"></script>
<script>window.jQuery || document.write('<script src="/ICP2017F/assets/js/vendor/jquery-1.11.1.min.js"><\/script>')</script>
<script src="/ICP2017F/assets/js/vendor/modernizr.js"></script>
<script src="/ICP2017F/assets/js/foundation.min.js"></script>

<script src="/ICP2017F/assets/js/notepad.js"></script>
<script src="/ICP2017F/assets/js/scripts.min.js"></script>
<script src="/ICP2017F/assets/js/vendor/nprogress.js"></script>
<script>$(document).foundation();</script>
<script type='text/javascript'>console.log("N/A");</script>
<script type='text/javascript'>console.log("https://www.cdslab.org/");</script>
<!--header anchor links-->
<script src="/ICP2017F/assets/js/autoAnchorLink.js"></script>
<!-- <script src="/ICP2017F/assets/js/prismOkaidia.js"></script>
<script src="/ICP2017F/assets/js/prismTwilight.js"></script>
<script src="/ICP2017F/assets/js/prismDefault.js"></script>
 -->
<script src="/ICP2017F/assets/js/prismCoy.js"></script>
<!-- Start of Ganal -->
<script>
    (function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
    (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
    m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
    })(window,document,'script','//www.google-analytics.com/analytics.js','ga');
    ga('create', 'UA-67460905-1', 'auto');
    ga('send', 'pageview');
</script>
<!-- End of Ganal--> 
<!--automatic Table of Content.-->
<script src="/ICP2017F/assets/js/autoTOC.js"></script>
</body>
</html>
